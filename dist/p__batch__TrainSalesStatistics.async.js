(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"6ANx":function(e,t,a){"use strict";var l=a("TqRt"),i=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var n=l(a("bx4M"));a("+L6B");var d=l(a("2/Rp"));a("miYZ");var s=l(a("tsqr")),c=l(a("lwsE")),u=l(a("W8MJ")),r=l(a("a1gu")),o=l(a("Nsbk")),h=l(a("7W2i")),f=l(a("PJYZ"));a("7Kak");var p=l(a("9yH6"));a("OaEy");var m=l(a("2fM7"));a("y8nQ");var v=l(a("Vl3Y"));a("g9YV");var b,I,y,g,x=l(a("wCAj")),N=i(a("q1tI")),D=a("MuoO"),E=l(a("mOP9")),S=l(a("d3jC")),C=a("RO9D"),k=(a("7cBs"),a("cA2t"),l(a("/Q2I"))),w=(x.default.Column,v.default.Item,m.default.Option,"YYYY-MM-DD"),A=p.default.Group,F=(b=(0,D.connect)(function(e){var t=e.batch,a=e.loading;return{batch:t,loading:a.models.list}}),I=v.default.create(),b(y=I((g=function(e){function t(e){var a;return(0,c.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.handleOnQuery=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){var l=(0,C.isEmptyObject)(t.startDate)?null:t.startDate.format(w),i=t.supplierId,n=t.batchId;(0,C.isEmptyObject)(i)?s.default.warn("\u8bf7\u9009\u62e9\u8d27\u4e3b"):(0,C.isEmptyObject)(n)?s.default.warn("\u8bf7\u9009\u62e9\u8f66\u6b21"):(a.updataState(l),a.fetchSelectCarIncome({supplierId:i,startDate:l,batchId:n}))}})},a.handleReset=function(){a.props.form.resetFields()},a.selectSupplier=function(){a.setState({visible:!0})},a.selectBatch=function(){a.setState({visible1:!0})},a.handleChange=function(e,t){a.setState({supplierId:e,name:t,visible:!1,val:null}),a.fetchBatchList({supplierId:e})},a.handleChangeBatch=function(e,t){a.setState({batchId:e,batchName:t,visible1:!1})},a.submit=function(){var e=a.state,t=e.supplierId,l=e.batchId,i=e.value;t&&l?1==i?a.fetchIncome({supplierId:t,batchId:l}):a.fetchGoodsDetails({supplierId:t,batchId:l}):s.default.warn("\u8bf7\u5148\u9009\u4e2d\u8d27\u4e3b\u4e0e\u8f66\u6b21!")},a._search=function(e){var t=e.target.value,l=a.state.suppliersData,i=""!==t?l.filter(function(e){return e.name.indexOf(t)>=0}):l;a.setState({listData:i,val:t})},a.hideModal=function(){a.setState({visible:!1,visible1:!1})},a.change=function(e){a.setState({value:e.target.value})},a.reset=function(){a.setState({supplierId:null,name:null,batchId:null,batchName:null})},a.state={startDate:0,loading:!1,visible:!1,visible1:!1,batchId:null,batchName:null,listData:[],value:1,suppliersData:[],val:null},a.updataState=a.updataState.bind((0,f.default)((0,f.default)(a))),a}return(0,h.default)(t,e),(0,u.default)(t,[{key:"componentDidMount",value:function(){this.fetchSupplierList({})}},{key:"updataState",value:function(e){this.setState({startDate:e,loading:!0})}},{key:"fetchSupplierList",value:function(e){var t=this;this.props.dispatch({type:"batch/fetchSupplierList",payload:e}).then(function(){var e=t.props.batch.supplierDataList,a=e&&!Array.isArray(e)?e.suppliers:[];t.setState({suppliersData:a})})}},{key:"fetchSelectCarIncome",value:function(e){var t=this;this.props.dispatch({type:"batch/fetchSelectCarIncome",payload:e}).then(function(e){t.setState({loading:!1})})}},{key:"fetchIncome",value:function(e){this.props.dispatch({type:"batch/fetchIncome",payload:e})}},{key:"fetchGoodsDetails",value:function(e){this.props.dispatch({type:"batch/fetchGoodsDetails",payload:e})}},{key:"fetchBatchList",value:function(e){this.props.dispatch({type:"batch/fetchBatchList",payload:e})}},{key:"render",value:function(){var e=this.props,t=e.batch,a=t.supplierDataList,l=(t.selectCarIncomeData,t.incomeData),i=t.batchListData,s=t.goodsDetailsData,c=(e.loading,this.props.form.getFieldDecorator,this.state),u=c.listData,r=c.name,o=c.batchId,h=c.batchName,f=c.value,m=c.val,v=[];void 0===a||Array.isArray(a)||null===a||(v=a.suppliers);var b=u.length!==v.length&&u.length&&m?u:v;void 0==i&&null==i&&(i=[]);var I=[{title:"\u54c1\u540d",dataIndex:"goodsName"},{title:"\u603b\u9500\u91cf",dataIndex:"saleNumber"},{title:"\u603b\u91cd\u91cf",dataIndex:"saleWeight"},{title:"\u8d27\u6b3e",dataIndex:"goodsAmount"},{title:"\u8d27\u6b3e\u96f6\u5dee",dataIndex:"extraAmount"},{title:"\u529b\u8d44",dataIndex:"tradeFee"},{title:"\u5f00\u7968\u8d39",dataIndex:"billFee"},{title:"\u704c\u5305\u8d39",dataIndex:"packFee"},{title:"\u8fc7\u78c5\u8d39",dataIndex:"weighingFee"},{title:"\u5747\u4ef7",dataIndex:"avgUnitPrice"}],y=[{title:"\u7968\u53f7",dataIndex:"todayNo"},{title:"\u54c1\u540d",dataIndex:"goodsAttrName"},{title:"\u603b\u9500\u91cf",dataIndex:"saleNumber"},{title:"\u603b\u91cd\u91cf",dataIndex:"saleWeight"},{title:"\u5355\u4ef7",dataIndex:"unitPrice"},{title:"\u8d27\u6b3e",dataIndex:"goodsAmount"},{title:"\u8d27\u6b3e\u96f6\u5dee",dataIndex:"extraAmount"},{title:"\u529b\u8d44\u8d39",dataIndex:"tradeFee"},{title:"\u5f00\u7968\u8d39",dataIndex:"billFee"},{title:"\u704c\u5305\u8d39",dataIndex:"packFee"},{title:"\u8fc7\u78c5\u8d39",dataIndex:"weighingFee"}],g=1==f?l||[]:s||[],D=1==f?I:y;return N.default.createElement("div",{className:S.default.batchLayout},N.default.createElement(n.default,{className:S.default.form,bordered:!1,title:"",extra:null},N.default.createElement("div",{className:S.default.formCard},N.default.createElement(d.default,{type:"primary",className:S.default.btn,onClick:this.selectSupplier},"\u8bf7\u9009\u62e9\u8d27\u4e3b"),N.default.createElement(d.default,{type:"primary",className:S.default.btn,onClick:this.selectBatch},"\u8bf7\u9009\u62e9\u8f66\u6b21"),N.default.createElement(d.default,{type:"primary",className:S.default.btn,onClick:this.submit},"\u67e5\u8be2"),N.default.createElement(d.default,{type:"primary",className:S.default.btn,onClick:this.reset},"\u91cd\u7f6e"),N.default.createElement(A,{onChange:this.change,value:this.state.value},N.default.createElement(p.default,{value:1},"\u6574\u8f66\u67e5\u8be2"),N.default.createElement(p.default,{value:2},"\u660e\u7ec6\u67e5\u8be2")),N.default.createElement(E.default,{className:[S.default.btn,S.default.printBtn],to:"batchdata?id=".concat(o,"&carNo=").concat(h)},"\u6253\u5370"))),N.default.createElement(n.default,{className:S.default.content,bordered:!1,title:"",extra:null},N.default.createElement("div",{className:S.default.contentHeader},N.default.createElement("div",{className:S.default.left},N.default.createElement("div",{className:S.default.block}),N.default.createElement("div",{className:S.default.name},"".concat(r||"---"," ").concat(h||"---")))),N.default.createElement("div",{className:S.default.contentTable})),N.default.createElement(k.default,{data:b,visible:this.state.visible,search:!0,searchText:"\u6309\u8d27\u4e3b\u59d3\u540d\u641c\u7d22",id:"user_id",name:"name",handleCancel:this.hideModal,_searchs:this._search.bind(this),handleChange:this.handleChange.bind(this)}),N.default.createElement(k.default,{data:i,visible:this.state.visible1,search:!1,id:"id",name:"carNo",text:this.state.name||"\u8bf7\u9009\u62e9\u8f66\u6b21",handleCancel:this.hideModal,handleChange:this.handleChangeBatch.bind(this)}),N.default.createElement(n.default,{className:S.default.listCard,bordered:!1,title:"",extra:null},N.default.createElement(x.default,{rowKey:"1",dataSource:g,pagination:!1,scroll:{x:800},bordered:!0,loading:this.state.loading,columns:D})))}}]),t}(N.PureComponent),y=g))||y)||y);t.default=F}}]);