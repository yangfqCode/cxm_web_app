(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{EKmz:function(e,t,a){"use strict";var l=a("TqRt"),n=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var u=l(a("bx4M"));a("14J3");var i=l(a("BMrR"));a("+L6B");var r=l(a("2/Rp")),s=l(a("pVnL"));a("jCWc");var d=l(a("kPKH"));a("iQDF");var c=l(a("+eQT")),f=l(a("lwsE")),o=l(a("W8MJ")),p=l(a("a1gu")),m=l(a("Nsbk")),v=l(a("7W2i"));a("OaEy");var h=l(a("2fM7"));a("y8nQ");var E=l(a("Vl3Y"));a("g9YV");var y,b,S,g,T=l(a("wCAj")),R=n(a("q1tI")),I=l(a("wd/R")),D=a("MuoO"),x=l(a("mOP9")),C=l(a("/Q2I")),L=a("RO9D"),w=l(a("xLbA")),k=T.default.Column,q=E.default.Item,M=h.default.Option,N="YYYY-MM-DD",O=(y=(0,D.connect)(function(e){var t=e.revenue,a=e.finance,l=e.loading;return{revenue:t,finance:a,loading:l.models.list}}),b=E.default.create(),y(S=b((g=function(e){function t(e){var a;return(0,f.default)(this,t),a=(0,p.default)(this,(0,m.default)(t).call(this,e)),a.handleOnQuery=function(e){a.setState({loading:!0}),e.preventDefault(),a.props.form.validateFields(["dateTime","supplierId","reqSaleType","batchStatus","batchId"],function(e,t){if(!e){var l=(0,L.isEmptyObject)(t.dateTime)?null:t.dateTime.format(N),n=a.state.supplierId;console.log(n),a.fetchRevenueList({dateTime:l,reqSaleType:void 0===t.reqSaleType?0:t.reqSaleType,batchStatus:void 0===t.batchStatus?0:t.batchStatus,supplierId:n})}})},a.handleReset=function(){a.props.form.resetFields(),a.setState({supplierId:null,supplierName:null,visible:!1})},a.selectSupplier=function(){var e=a.state.supplierListData;a.setState({visible:!0,suppliersData:e})},a._search=function(e){var t=e.target.value,l=a.state.suppliersData,n=""!==t?[].concat(l).filter(function(e){return e.name.indexOf(t)>=0}):l;a.setState({suppliersData:n})},a.handleChange=function(e,t){a.setState({supplierId:e,supplierName:t,visible:!1})},a.hideModal=function(){a.setState({visible:!1})},a.totalRevenueUp=function(){a.sortRevenueList(2)},a.totalRevenueDown=function(){a.sortRevenueList(1)},a.state={loading:!0,show:!1},a}return(0,v.default)(t,e),(0,o.default)(t,[{key:"componentWillMount",value:function(){}},{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("loginStatus");t?this.fetchSupplierList({}):setTimeout(function(){e.fetchSupplierList({})},1e3);var a=(0,I.default)(new Date,N).format(N);this.fetchRevenueList({dateTime:a})}},{key:"componentWillUnmount",value:function(){}},{key:"fetchRevenueList",value:function(e){var t=this;this.props.dispatch({type:"revenue/fetchRevenueList",payload:e}).then(function(){t.setState({loading:!1})})}},{key:"fetchSupplierList",value:function(e){var t=this;this.props.dispatch({type:"finance/fetchSupplierList",payload:e}).then(function(){var e=t.props.finance.supplierListData,a=e&&!Array.isArray(e)?e.suppliers:[];t.setState({suppliersData:a,supplierListData:a})})}},{key:"sortRevenueList",value:function(e){var t=this;this.setState({loading:!0}),this.props.form.validateFields(["dateTime","supplierId","reqSaleType","batchStatus","batchId"],function(a,l){if(!a){var n=(0,L.isEmptyObject)(l.dateTime)?null:l.dateTime.format(N),u=t.state.supplierId;t.fetchRevenueList({dateTime:n,reqSaleType:void 0===l.reqSaleType?0:l.reqSaleType,batchStatus:void 0===l.batchStatus?0:l.batchStatus,supplierId:u,orderByClause:e})}})}},{key:"render",value:function(){for(var e=this.props.revenue.revenueList,t=this.state,a=t.supplierName,l=t.suppliersData,n=this.props.form.getFieldDecorator,f=e||[],o=0,p=0;p<f.length;p++){var m=f[p];o+=m.totalRevenue}o=o.toFixed(2);var v=l,y={xs:5,sm:5,md:5,lg:5,xl:5,style:{marginBottom:12}},b={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},S=R.default.createElement("div",{className:w.default.extraContent},R.default.createElement(E.default,{onSubmit:this.handleOnQuery.bind(this),className:"login-form"},R.default.createElement(i.default,{gutter:24},R.default.createElement(d.default,y,R.default.createElement(q,null,n("dateTime",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65f6\u95f4!"}],initialValue:(0,I.default)(new Date,N)})(R.default.createElement(c.default,{allowClear:!1})))),R.default.createElement(d.default,y,R.default.createElement(q,(0,s.default)({},b,{label:"\u552e\u5356\u65b9\u5f0f"}),n("reqSaleType",{})(R.default.createElement(h.default,null,R.default.createElement(M,{value:"1"},"\u4ee3\u5356"),R.default.createElement(M,{value:"2"},"\u81ea\u8425"))))),R.default.createElement(d.default,y,R.default.createElement(q,(0,s.default)({},b,{label:"\u8f66\u6b21\u72b6\u6001"}),n("batchStatus",{})(R.default.createElement(h.default,null,R.default.createElement(M,{value:"1"},"\u5728\u552e"),R.default.createElement(M,{value:"2"},"\u552e\u7f44"))))),R.default.createElement(d.default,(0,s.default)({},y,{className:w.default.submitBtn}),R.default.createElement("div",null,R.default.createElement(r.default,{type:"primary",className:w.default.add,onClick:this.selectSupplier},"\u8bf7\u9009\u62e9\u8d27\u4e3b"),R.default.createElement("div",{className:w.default.name},"".concat(a||"---")))),R.default.createElement(d.default,{span:4,className:w.default.submitBtn},R.default.createElement(r.default,{type:"primary",htmlType:"submit"},"\u641c\u7d22"),R.default.createElement(r.default,{onClick:this.handleReset},"\u91cd\u7f6e"))),R.default.createElement("div",null,R.default.createElement("div",{style:{float:"left"}},R.default.createElement("span",{style:{color:"#60B941",fontSize:"16px"}},"\u6309\u7167\u603b\u6536\u76ca\u6392\u5e8f\uff1a"),R.default.createElement(r.default,{icon:"caret-up",onClick:this.totalRevenueUp}),R.default.createElement(r.default,{icon:"caret-down",onClick:this.totalRevenueDown})),R.default.createElement("div",{style:{float:"right"}},R.default.createElement("span",{style:{color:"#323232",fontSize:"24px"}},"\u5408\u8ba1\uff1a ",o))))),g={pageSize:10};return R.default.createElement("div",{className:w.default.billDetails},R.default.createElement(C.default,{data:v,visible:this.state.visible,search:!0,searchText:"\u6309\u8d27\u4e3b\u59d3\u540d\u641c\u7d22",id:"user_id",name:"name",handleCancel:this.hideModal,_searchs:this._search.bind(this),handleChange:this.handleChange.bind(this)}),R.default.createElement(u.default,{className:w.default.listCard,bordered:!1,title:"",extra:S},R.default.createElement(T.default,{id:"app",rowKey:"1",dataSource:f,pagination:g,scroll:{x:800},bordered:!0,loading:this.state.loading},R.default.createElement(k,{title:"\u8d27\u4e3b\u8f66\u6b21",dataIndex:"supplierCar"}),R.default.createElement(k,{title:"\u65e5\u671f",dataIndex:"dateTime"}),R.default.createElement(k,{title:"\u552e\u5356\u65b9\u5f0f",dataIndex:"saleType",render:function(e,t){var a=t.saleType;return R.default.createElement("span",null,0==a?"\u4ee3\u5356":"\u81ea\u8425")}}),R.default.createElement(k,{title:"\u72b6\u6001",dataIndex:"status",render:function(e,t){var a=t.status;return console.log("status==",a),R.default.createElement("span",null,7===a?"\u552e\u7f44":"\u5728\u552e")}}),R.default.createElement(k,{title:"\u603b\u6536\u76ca",dataIndex:"totalRevenue",render:function(e,t){var a=t.totalRevenue;return R.default.createElement("span",null,0==a?"--":a)},sorter:function(e,t){return e.totalRevenue-t.totalRevenue}}),R.default.createElement(k,{title:"\u8be6\u60c5",render:function(e,t){var a=t.batchId,l=t.dateTime;return R.default.createElement(x.default,{to:"/funds/revenueDetail?batchId=".concat(a,"&dateTime=").concat(l)},"\u67e5\u770b")}}))))}}]),t}(R.PureComponent),S=g))||S)||S);t.default=O}}]);